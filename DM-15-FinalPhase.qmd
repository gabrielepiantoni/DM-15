---
title: "DM-15-FinalPhase"
author: 
- "Dorian Nadal"
- "Gabriele Piantoni"
format: pdf
execute:
  echo: false      
  warning: false  
  message: false   
---


```{r}
#Setting: Here i am
#| message: false
here :: i_am("DM-15.Rproj")
```

```{r}
#Setting: Packages
#| message: false
library(here)
library(vroom)
library(tidyverse)
library(knitr)
library(broom)
library(knitr)
library(patchwork)
library(psych)
library(readxl)
```

```{r}
#Setting: Data Import
#| message: false
EDUSPEND<-vroom(here("PROJET","EDUCATION DATA SETS","Education spending (OECD).csv"))
EDUTAIN<-vroom(here("PROJET","EDUCATION DATA SETS","Educational attainment, at least completed short-cycle tertiary, population 25+, total (World Bank).csv"))
GDPMFP<-vroom(here("PROJET","GDP & MFP DATASETS","GDP, MFP and GDP per hour worked (OECD).csv"))
GROSPEND<-vroom(here("PROJET","R&D DATA SETS","Gross domestic spending in R&D, Researchers per countries & Tridic Patent families (OECD).csv"))
CPI <-vroom(here("PROJET","CPI.csv"))
L<-vroom(here("PROJET","L.csv"))
K<-vroom(here("PROJET","K.csv"))
```
```{r}
# Data cleaning, formating : clean the raw data from irrelevant information in contains
EDUSPEND <- EDUSPEND|>select(Pays, Indicateur, Sujet, Mesure, TIME_PERIOD, OBS_VALUE)
EDUTAIN <- EDUTAIN|>select(-c(`Country Code`, `Series Name`, `Series Code`))
GDPMFP <- GDPMFP |> select(Pays, Indicateur, Sujet, Mesure, TIME_PERIOD, OBS_VALUE)
GROSPEND <- GROSPEND |> select(Pays, Indicateur, Sujet, Mesure, TIME_PERIOD, OBS_VALUE)
```

```{r}
# Data cleaning, formating : split the data into different tables, each one displaying one indicator and its different measures
GDP<-GDPMFP |> filter(Indicateur=="Produit intérieur brut (PIB)") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)
MFP <- GDPMFP|>filter(Indicateur=="Productivité multifactorielle")|>pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)
PRODUCTIVITY <- GDPMFP |> 
  filter(Indicateur=="PIB par heure travaillée")|>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)
```

```{r}
# Data cleaning, formating : same as previous chunk
TRIAD <- GROSPEND |> 
  filter(Indicateur=="Familles de brevets triadiques") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)

STATERSC <- GROSPEND |> 
  filter(Indicateur=="Chercheurs du secteur de l’État") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)

RSC <- GROSPEND |> 
  filter(Indicateur=="Chercheurs") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)

SPENDRD <- GROSPEND |> 
  filter(Indicateur=="Dépenses intérieures brutes de R-D") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)

EDUTAIN <- EDUTAIN |>
  pivot_longer(cols = -`Country Name`,
               names_to = "Year",
               values_to = "Value" 
               )
```


```{r}
# Data cleaning, formating : setting TOTALEDUSPEND i the right format
TOTALEDUSPEND <- EDUSPEND|>filter(Indicateur=="Dépenses d'éducation")|>pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)
```

```{r}
# Data cleaning, formating : removing the code of each TIME_PERIOD to allow for datamanipulation
colnames(EDUTAIN) <- gsub("\\s\\[YR\\d{4}\\]", "", colnames(EDUTAIN))
#ChatGPT generated
```
```{r}
#filtering CPI
CPI <-CPI |>
  filter(Sujet=="Total") |>
  select(Pays,TIME_PERIOD,OBS_VALUE)
```

```{r}
# renaming column
CPI<-CPI |>
  rename(CPI = OBS_VALUE)
```

```{r}
#joining GDP and CPI data sets by two columns (Year, Pays)
GDP <-GDP |> 
  full_join(CPI, by=c("TIME_PERIOD","Pays"))
```

```{r}
# Computing realGDP
GDP <-GDP |>
  mutate(RealGDP=((`Millions de dollars US`/CPI)*100))
```

```{r}
# Computing realGDP per capita
GDP <-GDP |>
  mutate(RealGDPperCapita=((`Dollars US/habitant`/CPI)*100))
```

```{r}
# removing years after covid crisis not to have the catch up effect 
GDP <- GDP |>
  filter(TIME_PERIOD<="2020")
```

```{r}
#creating categroies of countries
#excluding Israël because of aberrant values
#excluding Russia because of aberrant values
#excluding Colombia because of aberrant values

GDP <- GDP |>
  mutate(`Euro Area and GB` = ifelse(Pays %in% c("France", "Ex-République fédérale d'Allemagne", "Finlande", "Lettonie", 
  "Slovénie", "Irlande", "Autriche", "Malte", "Italie", "Chypre", "Croatie", 
  "Portugal", "Pays-Bas", "Grèce", "République slovaque", "Luxembourg", 
  "Belgique", "Lituanie", "Estonie", "Espagne","Royaume-Uni" ), "YES", "NO"))
         
GDP <- GDP |>
  mutate(AsianTigers = ifelse(Pays %in% c("Corée", "Singapour"), "YES", "NO"))

GDP <- GDP |>
  mutate(EtatsUnis = ifelse(Pays %in% c("États-Unis"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(Europe = ifelse(Pays %in% c("Royaume-Uni", "France", "Allemagne", "Norvège", "Danemark", "Nouvelle-Zélande", "Suisse", "Finlande", "Suède", "Pays-Bas", "Autriche", "Irlande", "Tchéquie", "Slovénie", "Pologne","Lettonie", "Lituanie", "Estonie", "Bulgarie", "Roumanie", "Croatie", "Portugal", "Italie", "Grèce", "Espagne", "Belgique", "Luxembourg", "Serbie", "Albanie", "Macédoine du Nord"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(CentralEurope = ifelse(Pays %in% c("Allemagne", "Autriche", "Pologne", "Tchéquie", 
                    "Slovénie", "Slovaquie", "Hongrie", "France"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(SouthernEurope = ifelse(Pays %in% c("Portugal", "Espagne", "Italie", "Grèce", 
                     "Croatie", "Malte"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(EasternEurope = ifelse(Pays %in% c("Lettonie", "Lituanie", "Estonie"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(NorthernEurope = ifelse(Pays %in% c("Royaume-Uni", "Norvège", "Danemark", 
                     "Suède", "Finlande", "Pays-Bas", "Irlande"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(China = ifelse(Pays %in% c("Chine (République populaire de)"), "YES", "NO"))
```

```{r}
#creating binary variables to indicate if a country belongs to a category
# List of YES/NO variables
# computing average GDP (variables starting with v)
yes_no_variables <- c( 
                      "AsianTigers", 
                      "Europe",
                      "CentralEurope", 
                      "SouthernEurope", 
                      "EasternEurope", 
                      "NorthernEurope", 
                      "EtatsUnis",
                      "China",
                      "Euro Area and GB")

for (var in yes_no_variables) {
  GDP <- GDP |>
    group_by(TIME_PERIOD) |>
    mutate(!!paste0("v", var) := ifelse(!!sym(var) == "YES", 
                                        mean(RealGDP [!!sym(var) == "YES"], na.rm = TRUE), 
                                        NA)) |>
    ungroup()
}
```

```{r}
# computing average GDP per capita
# variables starting with c
for (var in yes_no_variables) {
  GDP <- GDP |>
    group_by(TIME_PERIOD) |>
    mutate(!!paste0("c", var) := ifelse(!!sym(var) == "YES", 
                                        mean(RealGDPperCapita [!!sym(var) == "YES"], na.rm = TRUE), 
                                        NA)) |>
    ungroup()
}
```


```{r}
#| output: false
#Graphs: Real GDP per capita - Euro Area and GB, ASIANTIGERS, China, united states

graph1 <-GDP |>
  pivot_longer(cols = c("cEtatsUnis", 
                   "cAsianTigers", 
                   "cChina",
                   "cEuro Area and GB"),
               names_to = "Region",
               values_to="avgGDP"
               ) |>
  filter(!is.na(avgGDP)) |>
  filter(TIME_PERIOD >=1995) |>
  ggplot(aes(y=avgGDP, x=TIME_PERIOD, color=Region, group=Region)) +
  geom_line(size=1.4)+
  scale_color_manual(
    values = c("darkred", "blue", "darkgreen", "darkorange"),
                     labels = c("Asian Tigers", "China", "United States", "EuroArea and Great Britain"))+
  labs(
    title = "GDP per capita by Region (1995-2020)",
    x = "Year",
    y = "Real GDP per capita",
    color = "Region"
  ) 

```


```{r}
#| output: false
#Graphs: Real GDP - EUROPE
graph2<-GDP |>
  pivot_longer(cols = c("cEurope", 
                      "cCentralEurope", 
                      "cSouthernEurope", 
                      "cEasternEurope", 
                      "cNorthernEurope"),
               names_to = "Region",
               values_to="avgGDP"
               ) |>
  filter(!is.na(avgGDP)) |>
  filter (TIME_PERIOD>=1995) |>
  ggplot(aes(y=avgGDP, x=TIME_PERIOD, color=Region)) +
  geom_line(size=1.4)+
  scale_color_manual(
    values = c("darkred", "blue", "darkgreen", "darkorange", "grey"),
                     labels = c("Central Europe", "Eastern Europe", "Europe", "Northern Europe", "Southern Europe"))+
  labs(
    title = "GDP per capita by Region - Europe (1995-2020)",
    x = "Year",
    y = "Real GDP per capita",
    color = "Region"
  ) 
```

# Research question presentation

## Introduction to our research question

 In recent decades, most of the countries has achieved sustained positive growth, leading them to a marked improvement in their quality of life.
That said, recent years have shown, especially in the more developed economies, a slow down in this trend. To date, the consensus seems to agree that the slowdown of the explosive growth that persisted for most of the 20th century is to be attributed to a less sustained increase in technical change which, according to theory, is strongly linked also to the amount of resources devoted to research and education.
Well, given the relevance of the topic, we thought it would be interesting to analyse the accuracy of the latter hypothesis. Consequently, this paper aims to answer the question: ***is there a causal relationship between resources spent on research, education and growth in technical change?***

## The research structure and the methodology

The research is essentially based on two distinct phases.

A first phase, introduced for the sake of completeness, where the objective is to demonstrate the validity of the neoclassical theory that technological change is the foundation of economic growth. 
A second phase, the core of the research, where the objective is to answer the research question by determining whether there is indeed a causal relationship between research, education and TFP growth.

In both phases, the use of **panel linear regressions analysis** played a decisive role in the conduct of the research, using models widely supported by the literature as a benchmark.

## The Framework

Since the purpose of our research was to highlight a possible causal relationship in a broad sense, essentially no constraints were placed on either the time frame considered or the countries examined.

## The ultimate goal

This paper aims to verify a causal relationship. The ultimate goal is to empirically and statistically highlight the centrality of research and education in the economic development of a country, confirming the theory as a starting point for the design of economic policies.

# Data Description

 - **Gross Domestic Product** (source: OECD Data Explorer).
Nominal Gross Domestic Product in US$ and US$/capita ratio.
 
```{r}

stats1 <- GDP |> select(`Dollars US/habitant`, `Millions de dollars US`) |> describe()

mean_value <- stats1["mean"]
sd_value <- stats1["sd"]
n_value <- stats1["n"]

numcountries <- GDP |> distinct(Pays) |> nrow()

firstyear <- min(GDP$TIME_PERIOD, na.rm = TRUE)
lastyear <- max(GDP$TIME_PERIOD, na.rm = TRUE)

finaltable <- data.frame(
  "mean "= mean_value,
  "SD" = sd_value,
  "Observations" = n_value,
  "Countries" = numcountries,
  "From" = firstyear,
  "To" = lastyear
)

kable(finaltable, caption = "GDP: Mean, Standard Deviation, Number of Observations and Number of Countries")


```
 - **Inflation (CPI)** (source: OECD Data Explorer).
CPI (Consumption Price Index) considering 2015 as the base year (ie. 2015=100)
 
```{r}
stats1 <- GDP |> select(CPI) |> pull() |> describe()

mean <- stats1["mean"]
sd <- stats1["sd"]
n <- stats1["n"]

ncountries <- GDP |> distinct(Pays) |> nrow()

firstyear <- min(GDP$TIME_PERIOD, na.rm = TRUE)
lastyear <- max(GDP$TIME_PERIOD, na.rm = TRUE)

finaltable <- data.frame(
  "mean"= mean,
  "SD" = sd,
  "Observations" = n,
  "Countries" = ncountries,
  "From" = firstyear,
  "To" = lastyear
)

kable(finaltable, caption = "CPI: Mean, Standard Deviation, Number of Observations and Number of Countries")
```

 - **Multifactor productivity** (source: OECS Data Explorer)
 Annual growth rate (%) of Total Factor Productivity.
```{r}
stats1 <- MFP |> select(`Taux de croissance annuel (%)`) |> pull() |> describe()

mean <- stats1["mean"]
sd <- stats1["sd"]
n <- stats1["n"]

num <- MFP |> distinct(Pays) |> nrow()

firstyear <- min(MFP$TIME_PERIOD, na.rm = TRUE)
lastyear <- max(MFP$TIME_PERIOD, na.rm = TRUE)

finaltable <- data.frame(
  "mean"= mean,
  "SD" = sd,
  "Observations" = n,
  "Countries" = num,
  "From" = firstyear,
  "To" = lastyear
)

kable(finaltable, caption = "MFP: Mean, Standard Deviation, Number of Observations and Number of Countries")
```
 
 - **Investement (GFCF)** (source: OECD Data Explorer)
 Annual growth rate (%) of GFCF (Gross fixed capital formation)
```{r}
stats1 <- K |> select(OBS_VALUE) |> pull() |> describe()

mean<- stats1["mean"]
sd <- stats1["sd"]
n <- stats1["n"]

ncountries <- K |> distinct(Pays) |> nrow()

firstyear <- min(K$TIME_PERIOD, na.rm = TRUE)
lastyear <- max(K$TIME_PERIOD, na.rm = TRUE)

finaltable <- data.frame(
  "mean"= mean,
  "SD" = sd,
  "Observations" = n,
  "Countries" = ncountries,
  "From" = firstyear,
  "To" = lastyear
)

kable(finaltable, caption = "Investments (GFCF): Mean, Standard Deviation, Number of Observations and Number of Countries")
```
 
 - **Hours worked** (source: OECD Data Explorer)
 Hours worked annually expressed as the ratio of total hours worked to the number of workers
```{r}
#Pivoting in order to create the statistical summary table
L1<-L|>pivot_wider( 
            names_from = Mesure, 
            values_from = OBS_VALUE)
```

 
```{r}
stats1 <- L1 |> filter(!is.na(`Heures/travailleur`))|> select(`Heures/travailleur`) |> pull() |> describe()

mean<- stats1["mean"]
sd <- stats1["sd"]
n <- stats1["n"]

ncountries <- L1|>select(`Heures/travailleur`, Pays) |> distinct(Pays) |> nrow()

firstyear <- min(L1$TIME_PERIOD, na.rm = TRUE)
lastyear <- max(L1$TIME_PERIOD, na.rm = TRUE)

finaltable <- data.frame(
  "mean"= mean,
  "SD" = sd,
  "Observations" = n,
  "Countries" = ncountries,
  "From" = firstyear,
  "To" = lastyear
)

kable(finaltable, caption = ": Hours/worker: Mean, Standard Deviation, Number of Observations and Number of Countries")
```
 
 - **Labur Force** (source: OECD Data Explorer)
 Active population expressd in million of units.

```{r}
stats1 <- L1 |>  select(`Milliers de personnes`) |> pull() |> describe()


mean <- stats1["mean"]
sd <- stats1["sd"]
n <- stats1["n"]

ncountires <- L1|>select(`Milliers de personnes`, Pays) |> distinct(Pays) |> nrow()

firstyear <- min(L1$TIME_PERIOD, na.rm = TRUE)
lastyear <- max(L1$TIME_PERIOD, na.rm = TRUE)

finaltable <- data.frame(
  "mean"= mean,
  "SD" = sd,
  "Observations" = n,
  "Countries" = ncountries,
  "From" = firstyear,
  "To" = lastyear
)

kable(finaltable, caption = "Labour force: Mean, Standard Deviation, Number of Observations, Number of Countries, and First/Last Year for CPI")
```
- **Education spending** (source: OECD Data Explorer)
 Expenditure in education - divided into primary, secondary and tertiary - in both %GDP and US$/Student ratio.
 
```{r}
stats1 <- TOTALEDUSPEND |> select(`Dollars US/étudiant`) |> pull() |> describe()

mean <- stats1["mean"]
sd <- stats1["sd"]
n <- stats1["n"]

ncountries <- TOTALEDUSPEND |> distinct(Pays) |> nrow()

firstyear <- min(TOTALEDUSPEND$TIME_PERIOD, na.rm = TRUE)
lastyear <- max(TOTALEDUSPEND$TIME_PERIOD, na.rm = TRUE)

finaltable <- data.frame(
  "mean"= mean,
  "SD" = sd,
  "Observations" = n,
  "Countries" = ncountries,
  "From" = firstyear,
  "To" = lastyear
)

kable(finaltable, caption = "Education expenditure: Mean, Standard Deviation, Number of Observations and Number of Countries")
```

 - **Gross Domestic Spending on R&D** (source: OECD Data Explorer)
  Gross domestic spending on R&D measured in Million US dollar and percentage of GDP.

```{r}
stats1 <- SPENDRD |> select(`Millions de dollars US`) |> pull() |> describe()

mean <- stats1["mean"]
sd <- stats1["sd"]
n <- stats1["n"]

ncountries <- SPENDRD |> distinct(Pays) |> nrow()

firstyear <- min(SPENDRD$TIME_PERIOD, na.rm = TRUE)
lastyear <- max(SPENDRD$TIME_PERIOD, na.rm = TRUE)

finaltable <- data.frame(
  "mean"= mean,
  "SD" = sd,
  "Observations" = n,
  "Countries" = ncountries,
  "From" = firstyear,
  "To" = lastyear
)

kable(finaltable, caption = "R&D expenditure: Mean, Standard Deviation, Number of Observations and Number of Countries")
```
 - **Trade in good and services** (source: OECD Data Explorer)
Transaction in goods and services between residents and non-resident in Million US$ at 2015 constant price.

```{r}
TRADE<-vroom(here("PROJET", "Trade.csv"))
TRADE<-TRADE|>pivot_wider(names_from = MEASURE, values_from = OBS_VALUE)
```

```{r}


stats1 <- TRADE |> select(`MLN_USD`) |> pull() |> describe()

mean <- stats1["mean"]
sd <- stats1["sd"]
n <- stats1["n"]

ncountries <- TRADE |> distinct(Pays) |> nrow()

firstyear <- min(TRADE$TIME_PERIOD, na.rm = TRUE)
lastyear <- max(TRADE$TIME_PERIOD, na.rm = TRUE)

finaltable <- data.frame(
  "mean"= mean,
  "SD" = sd,
  "Observations" = n,
  "Countries" = ncountries,
  "From" = firstyear,
  "To" = lastyear
)

kable(finaltable, caption = "Trade: Mean, Standard Deviation, Number of Observations and Number of Countries")
```







```{r}

Institutions<-read_excel(here("PROJET", "Institutions.xlsx"))|>filter(indicator=="rq")|>select(countryname, year, estimate)
```
 - **Quality of Regulations** (Source: World Bank Data Bank)
Perceptions of the ability of the government to formulate and implement sound policies and regulations that permit and promote private sector development

```{r}
Institutions$estimate<-as.numeric(Institutions$estimate)

stats1 <- Institutions |> select(`estimate`) |> pull() |> describe()

mean <- stats1["mean"]
sd <- stats1["sd"]
n <- stats1["n"]

ncountries <- Institutions |> distinct(countryname) |> nrow()

firstyear <- min(Institutions$year, na.rm = TRUE)
lastyear <- max(Institutions$year, na.rm = TRUE)

finaltable <- data.frame(
  "mean"= mean,
  "SD" = sd,
  "Observations" = n,
  "Countries" = ncountries,
  "From" = firstyear,
  "To" = lastyear
)

kable(finaltable, caption = "Quality of regulation: Mean, Standard Deviation, Number of Observations and Number of Countries")
```
# Data Analysis

## Stylized facts: the relarionship within groeth rate of GDP and TFP

### The performance of world economies in recent decades: a positive scenario

As mentioned above, the economic development of several countries has undergone positive growth in recent decades. In the following graphs (*Graph 1* and *Graph 2*), this phenomenon is highlighted. 

With the aim of obtaining a more coherent representation of the economic development of a selected group of countries and to express more adequately the level of welfare, the graphs below displays **real GDP per capita** - obtaining applying the inflation (CPI) to the nominalk GDP - over the period between 1995 and 2020.

More in detail,

 - *Graph 1* contains data for the USA, Asian Tigers (North Korea and Singapore), China and EuroArea (2023).
 - *Graph 2* contains data for European countries by geographical location
```{r}
#| fig.width: 12
#| fig.height: 4
graph1 + graph2 +
  plot_layout(widths = c(10, 10))
```

```{r}
#Computing the growth rate of GDP
GDP <- GDP |>
  group_by(Pays) |>
arrange(TIME_PERIOD)|> mutate(growth_rateY = ((RealGDP- lag(RealGDP)) / lag(RealGDP)) * 100) |>
  arrange(Pays,TIME_PERIOD)
```

```{r}
#| output: false
#Graphs: Growth_rate GDP - Germany, France, US and South Corea
graph3 <- GDP |>
  filter(Pays %in% c("France", "États-Unis", "Allemagne", "Corée")) |>
  ggplot(aes(x = TIME_PERIOD, y = growth_rateY, color = Pays)) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_manual(
    values = c("darkred", "darkorange", "darkgreen", "grey"),
    labels = c("France" = "France", 
               "États-Unis" = "United States", 
               "Allemagne" = "Germany", 
               "Corée" = "South Korea")
  ) +
  labs(
    title = "GDP Growth Rate",
    x = "Time Period",
    y = "Growth Rate of GDP",
    color = "Country"
  )


```

```{r}
#| output: false
##Graphs: TFP growth - Germany, France, US and South Corea
graph4<-MFP|>
   filter(Pays=="France"|Pays== "Chine (République populaire de)"|Pays== "États-Unis"|Pays== "Allemagne"|Pays== "Corée") |>
  ggplot(aes(x=TIME_PERIOD, y=`Taux de croissance annuel (%)`, color=Pays)) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_manual(
    values = c("darkred", "darkorange", "darkgreen", "grey"),
    labels = c("France" = "France", 
               "États-Unis" = "United States", 
               "Allemagne" = "Germany", 
               "Corée" = "South Korea")
  ) +
  labs(
    title = "TFP Growth Rate",
    x = "Time Period",
    y = "Growth Rate of TFP",
    color = "Country"
  )
```
### Not all that glitters is gold: the slowdown in economic growth

Although growth in recent decades has remained positive, it has been declining in several world economies. *Graph 3* gives an initial and rough idea of this phenomenon.
Looking again at some of the countries included in the sample used in *Graph 1* and *Graph 2*, *Graph 3* shows a fall in the **growth rate of real GDP** in countries of global significance, such as the USA, Germany, France and South Korea.

### *Could technical change (TFP) be the culprit in the growth slowdown?*

Economic literature has always theorised the centrality of technical change within economic expansion.  *Graph 4*, together with the already presented *Graph 3*, attempts to give an initial empirical insight into this relationship.
*Graph* 4, which considers the same countries used in the previous chart, highlights the development of TFP growth between 1970 and 2020. As can easily be seen, the graphical relationship with *Graph 4* is evident, suggesting a possible **causal relationship between TFP and GDP growth**.
```{r}
#| fig.width: 12
#| fig.height: 4
graph3+graph4
```

```{r}
#formatting L
L<-L |>
  select(TIME_PERIOD,Pays,Indicateur, OBS_VALUE )
L<-L |>
  pivot_wider(names_from = Indicateur,
              values_from = OBS_VALUE)
```

```{r}
#Computing total hours worked
L<-L |>
  mutate(L = `Population active`*`Heures travaillées`)
```

```{r}
# Computing the growth rate of L
L<-L |>
  group_by(Pays) |>
arrange(TIME_PERIOD)|> mutate(growth_rateL = ((L- lag(L)) / lag(L)) * 100) |>
  arrange(Pays,TIME_PERIOD)
```

```{r}
# Cleaning K
K<-K |> 
  select(Pays, TIME_PERIOD, Mesure, OBS_VALUE) |>
  filter(Mesure=="Taux de croissance annuel (%)") |>
  pivot_wider(names_from=Mesure, 
              values_from=OBS_VALUE) |>
  arrange(Pays, TIME_PERIOD) |>
  rename(growth_rateK= `Taux de croissance annuel (%)` )
```

```{r}
# Creating the dataset for growth decomposition
Dec <- GDP |>
  select(Pays, TIME_PERIOD, growth_rateY)
```

```{r}
# Creating the dataset for growth decomposition
Dec<-Dec |>
  full_join(K, Dec, by=c("TIME_PERIOD", "Pays"))
```

```{r}
# Creating the dataset for growth decomposition
Dec <- Dec |>
  full_join(L, Dec, by=c("TIME_PERIOD", "Pays")) |>
  select(, Pays, TIME_PERIOD, growth_rateY, growth_rateK, growth_rateL)
```

```{r}
# Creating the dataset for growth decomposition
MFP <- MFP |>
  rename(growth_rateA=`Taux de croissance annuel (%)`)
```

```{r}
# Creating the dataset for growth decomposition
Dec <-Dec |>
  full_join(MFP, Dec, by=c("TIME_PERIOD", "Pays")) |>
  select(Pays, TIME_PERIOD, growth_rateY, growth_rateK, growth_rateL, growth_rateA)
```

```{r}
#| output: false
# Creating the dataset for growth decomposition : checking the accuracy
Dec |>
  mutate(check=growth_rateY-(0.33*growth_rateK+0.66*(growth_rateL+ growth_rateA))) |>
  filter(Pays=="France" | Pays=="Allemagne"| Pays=="Corée")
```
### Technical change and economic growth: a causal relationship

Although the result of the previous section is interesting, its statistical relevance is far from being achieved. For this reason, in the current section we will draw more statistically relevant conclusions.

Considering the typical neoclassical production function
$$
Y = (AL)^{1−\alpha}K^{\alpha}
$$
, output growth (i.e. GDP) - taking logs and derivatives - can be decomposed into the following components: capital growth ($g_K$), labour force growth ($g_L$) and TFP growth ($g_A$). Consequently, the benchmark formula becomes
$$
g_Y = \alpha g_K + (1 - \alpha)(g_A + g_L)
$$
sing $\alpha$=1/3, as it is the commonly used value for this parameter and this value tends to remain the same over time (Kaldor fact: the share of capital in production tends to be constant).
At this point, it is crucial to demonstrate the empirical validity of this formula by referring to the period between 1990 and 2020.
*Figure 5*, which considers the USA, France and Germany, decomposes the growth that occurred over the 30-year period, considering both variables endogenous and exogenous to the model. As can be seen from the representation, the explanatory variables largely justify the economic growth trend.
```{r}
# France
# Solow-Swan model
Solow <- Dec |>
  filter(Pays == "France") |>
  arrange(TIME_PERIOD) |>
  mutate(
    growth_rateY = (100 + growth_rateY) / 100,
    growth_rateK = (100 + growth_rateK) / 100,
    growth_rateL = (100 + growth_rateL) / 100,
    growth_rateA = (100 + growth_rateA) / 100
  ) |>
  filter(TIME_PERIOD >= 1990 & TIME_PERIOD <= 2015) |>
  mutate(
    growth_rate_totalL = 0.66*prod(growth_rateL),
    growth_rate_totalY = prod(growth_rateY),
    growth_rate_totalK = 0.33*prod(growth_rateK),
    growth_rate_totalA = 0.66*prod(growth_rateA)
  ) |>
  mutate(others = growth_rate_totalY - growth_rate_totalK - growth_rate_totalL - growth_rate_totalA)|>
  select(growth_rate_totalL, growth_rate_totalA, growth_rate_totalK, others, growth_rate_totalY)
```

```{r}
#| output: false
# France 
Solow1 <- Solow |>
  pivot_longer(
    cols = c(growth_rate_totalL, growth_rate_totalA, growth_rate_totalK, others),
    names_to = "Component",
    values_to = "Value"
  )

# Bar chart decomposition
graph5 <- ggplot(Solow1, aes(x = "", y = Value, fill = Component)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Growth rate decomposition (France, Germany,USA, 1990-2015)",
    x = NULL,
    y = "Growth Rate Contribution",
    fill = "Component"
  ) +
  scale_fill_brewer(
    palette = "Set2")+
  theme(
    plot.title = element_text(face = "bold", size = 40))+
  theme_minimal() +
  theme(legend.position = "none", axis.text.x = element_blank(), axis.ticks.x = element_blank())
```


```{r}
# Germany
# Solow-Swan model
Solow2 <- Dec |>
  filter(Pays == "Allemagne") |>
  arrange(TIME_PERIOD) |>
  mutate(
    growth_rateY = (100 + growth_rateY) / 100,
    growth_rateK = (100 + growth_rateK) / 100,
    growth_rateL = (100 + growth_rateL) / 100,
    growth_rateA = (100 + growth_rateA) / 100
  ) |>
  filter(TIME_PERIOD >= 1990 & TIME_PERIOD <= 2015) |>
  mutate(
    growth_rate_totalL = 0.66*prod(growth_rateL),
    growth_rate_totalY = prod(growth_rateY),
    growth_rate_totalK = 0.33*prod(growth_rateK),
    growth_rate_totalA = 0.66*prod(growth_rateA)
  ) |>
  mutate(others = growth_rate_totalY - growth_rate_totalK - growth_rate_totalL - growth_rate_totalA)|>
  select(growth_rate_totalL, growth_rate_totalA, growth_rate_totalK, others, growth_rate_totalY)
```

```{r}
#| output: false
# Germany 
Solow3 <- Solow2 |>
  pivot_longer(
    cols = c(growth_rate_totalL, growth_rate_totalA, growth_rate_totalK, others),
    names_to = "Component",
    values_to = "Value"
  )

# Bar chart decomposition
graph6<-ggplot(Solow3, aes(x = "", y = Value, fill = Component)) +
  geom_bar(stat = "identity") +
  labs(
    title = NULL,
    x = NULL,
    y = NULL,
    fill = "Component"
  ) +
 scale_fill_brewer(
    palette = "Set2")+
  theme_minimal() +
  theme(legend.position = "none", axis.text.x = element_blank(), axis.ticks.x = element_blank())
  theme_minimal() +
  theme(legend.position = "none", axis.text.x = element_blank(), axis.ticks.x = element_blank())
```

```{r}
# USA
# Solow-Swan model
Solow4 <- Dec |>
  filter(Pays == "États-Unis") |>
  arrange(TIME_PERIOD) |>
  mutate(
    growth_rateY = (100 + growth_rateY) / 100,
    growth_rateK = (100 + growth_rateK) / 100,
    growth_rateL = (100 + growth_rateL) / 100,
    growth_rateA = (100 + growth_rateA) / 100
  ) |>
  filter(TIME_PERIOD >= 1990 & TIME_PERIOD <= 2015) |>
  mutate(
    growth_rate_totalL = 0.66*prod(growth_rateL),
    growth_rate_totalY = prod(growth_rateY),
    growth_rate_totalK = 0.33*prod(growth_rateK),
    growth_rate_totalA = 0.66*prod(growth_rateA)
  ) |>
  mutate(others = growth_rate_totalY - growth_rate_totalK - growth_rate_totalL - growth_rate_totalA)|>
  select(growth_rate_totalL, growth_rate_totalA, growth_rate_totalK, others, growth_rate_totalY)
```

```{r}
#| output: false
# USA 
Solow5 <- Solow4 |>
  pivot_longer(
    cols = c(growth_rate_totalL, growth_rate_totalA, growth_rate_totalK, others),
    names_to = "Component",
    values_to = "Value"
  )

# Bar chart decomposition
graph7 <-ggplot(Solow5, aes(x = "", y = Value, fill = Component)) +
  geom_bar(stat = "identity")  +
  labs(
    title = NULL,
    x = NULL,
    y = NULL,
    fill = "Component"
  ) +scale_fill_brewer(
    palette = "Set2",
    labels = c("growth_rate_totalA"="TFP share","growth_rate_totalK"="Capital share", "growth_rate_totalL"="Labour share", "others"="Others"))+
  theme_minimal() +
  theme(axis.text.x = element_blank(), axis.ticks.x = element_blank())
```

```{r}
#| fig.width: 12
#| fig.height: 4
graph5+graph6+graph7
```
Once the reliability of the model has been proven, the causality of the relationship between TFP and GDP growth can be demonstrated using **linear regressions** where $g_Y$ (i.e. dependent variable) is demonstrated through the components (i.e. independent variables) $g_L$, $g_K$ and $g_A$.

In the first instance, the results of an all-inclusive linear regression are demonstrated in *Table 1*. As shown, statistical significance levels (ie. p value < 0.5) are met and an interesting coefficient is attributed to the $g_A$ component, emphasising the intensity of the causal relationship between TFP and GDP.

```{r}
#linear model : regression of L, K, A on Y
summary(lm(formula =growth_rateY~growth_rateK+growth_rateL+growth_rateA, data=na.exclude(Dec))) |>
  tidy()|>
  mutate(p.value=as.character(p.value))|>
  kable( 
      caption = "Summary of Linear Model Coefficients", 
      col.names = c("Term", "Estimate", "Std. Error", "t value", "p value"))
```
On the other hand, *Table 2* shows a  $R^2$ and an adjusted $R^2$ of 0.32. Nevertheless, considering that the aim of our model is not to make forecasts, we can be satisfied with such a value.
```{r}
lm(formula =growth_rateY~growth_rateK+growth_rateL+growth_rateA, data=na.exclude(Dec))|>
summary() |>
  (\(x) data.frame(
    Statistic = c("N", "R2", "Adjusted R2"),
    Value = c(x$df[1] + x$df[2], x$r.squared, x$adj.r.squared)
  ))() |>
  kable(
    caption = "Model Summary Statistics",
    col.names = c("Statistic", "Value")
  )

```


Moreover, *Table 3* shows the results of a linear regression controlling for individual countries. Again, the significance levels for the above components are statistically acceptable and the coefficients tend to the values previously obtained and the causality between GDP and TFP is confirmed. In addition, the coefficient for the binary variable associated with different countries are globally not significant, that is, differences across countries do not add much information about the relation between TFP growth and GDP growth.


```{r}
#linear model : regression of L, K, A on Y

summary(lm(formula =growth_rateY~growth_rateK+growth_rateL+growth_rateA+Pays, data=na.exclude(Dec))) |>
  tidy()|>
  mutate(p.value=as.character(p.value))|>
  kable( 
      caption = "Summary of Linear Model Coefficients", 
      col.names = c("Term", "Estimate", "Std. Error", "t value", "p value"))
```
On the other hand, *Table 4* shows a  $R^2$ of 0.39 and an adjusted $R^2$ of 0.37. Nevertheless, considering that the aim of our model is not to make forecasts, we can be satisfied with such a value.
```{r}
lm(formula = growth_rateY ~ growth_rateK + growth_rateL + growth_rateA + Pays, data = na.exclude(Dec)) |>
summary() |>
  (\(x) data.frame(
    Statistic = c("N", "R2", "Adjusted R2"),
    Value = c(x$df[1] + x$df[2], x$r.squared, x$adj.r.squared)
  ))() |>
  kable(
    caption = "Model Summary Statistics",
    col.names = c("Statistic", "Value")
  )

```
Considering these evidence and the theoretical framework provided, we can believe, with confidence, in the existence of a strong causal relationship between TFP growth and GDP growth.


```{r}
# showing the correlation between research spendings and TFP in a graph
SPENDRD |>
  full_join(MFP,SPENDRD , by=c("TIME_PERIOD", "Pays")) |>
  group_by(Pays) |>
  mutate(value2015=`Millions de dollars US`[TIME_PERIOD=="2015"]) |>
  mutate(`rsc2015=100`=`Millions de dollars US`/value2015) |>
  ungroup()|>
ggplot(aes(x = `rsc2015=100`, y = `2015=100`)) +
  geom_point(size = 1, alpha = 0.5)+
  geom_smooth(method = "lm", se = FALSE, size = 1.2) +
  labs(
    title = "Relationship Between Research and TFP",
    x = "Research Spending",
    y = "TFP",    
   ) +
  theme_minimal() + 
  theme(
    plot.title = element_text(size = 16, face = "bold")
  ) +
  theme(legend.position = "none")
```




```{r}
# loading institution dataset 
INST<-read_excel(here("PROJET","Institutions.xlsx"))
```

```{r}
# keeping the indicator of interest
INST <- INST |>
  filter(indicator=="rq") |>
  select(countryname, year, estimate)
```

```{r}
# Matching country names in INST with the names in french in other data sets, same for the variable Year(to TIME_PERIOD), and change the estimate (to rq) name in prevision for the join


englishnames <- c("United States", "France", "Belgium", "Netherlands", "Japan",
                   "Australia", "New Zealand", "Spain", "Canada", "Germany",
                   "Ireland", "Denmark", "Portugal", "Sweden", "Italy",
                   "United Kingdom", "Finland", "Austria", "Switzerland",
                   "Norway", "Korea", "Israel", "Greece", "Luxembourg")

frenchnames <- c("États-Unis", "France", "Belgique", "Pays-Bas", "Japon",
                  "Australie", "Nouvelle-Zélande", "Espagne", "Canada", "Allemagne",
                  "Irlande", "Danemark", "Portugal", "Suède", "Italie",
                  "Royaume-Uni", "Finlande", "Autriche", "Suisse",
                  "Norvège", "Corée", "Israël", "Grèce", "Luxembourg")

names <- data.frame(English = englishnames, French = frenchnames)

INST <- INST |>
  filter(countryname %in% englishnames) |> 
  left_join(names, by = c("countryname" = "English")) |> 
  mutate(countryname = French) |> 
  select(-French) |>
  rename(Pays=countryname, 
         TIME_PERIOD = year, 
         rq = estimate)
```

```{r}
# setting rq as a numerical variable
#|output: false
typeof(INST$rq)
```

```{r}
# setting rq as a numerical variable
INST <- INST |>
  mutate(rq=as.numeric(rq))
```

## Trade

```{r}
# importing TRADE dataset and selecting relevant variables
TRADE<-vroom(here("PROJET","Trade.csv"))
TRADE <- TRADE |>
  select(Pays, TIME_PERIOD, OBS_VALUE)
```
```{r}
# renaming variable for clarity
TRADE <- TRADE |>
  rename(`Imports-millionsUSD` = OBS_VALUE)
```

```{r}
# computing ratio/GDP

TRADE <- full_join(TRADE, GDP, by=c("TIME_PERIOD", "Pays" )) |>
  select(Pays, TIME_PERIOD, RealGDP,`Imports-millionsUSD` )
TRADE <-TRADE |>
  mutate(`Imports%GDP`= (`Imports-millionsUSD`/RealGDP)*100) |>
  select(-RealGDP, -`Imports-millionsUSD`)
```


```{r}
# selecting GDPperCAPITA in GDP dataset
GDPcapita <- GDP |>
  select(Pays, TIME_PERIOD, RealGDPperCapita)
```


```{r}
# computing the spending in research in base 100 = 2015, removing other variables
SPENDRD <- SPENDRD |>
  group_by(Pays) |>
  mutate(value2015=`Millions de dollars US`[TIME_PERIOD=="2015"]) |>
  mutate(`rsc2015=100`=(`Millions de dollars US`/value2015)*100) |>
  ungroup() |>
  select(-Indicateur, -Sujet, -`% du PIB`, -`Millions de dollars US`, -value2015)
```


```{r}
# keeping only spendings in tertiary education (USd per student) in TOTALEDUSPEND and arranging it into a variable
TOTALEDUSPEND <- TOTALEDUSPEND |>
  filter(Sujet=="Supérieur") |>
  pivot_wider(names_from=Sujet,
              values_from=`Dollars US/étudiant`
  ) |>
  select(-`% du PIB`, -Indicateur, ) |>
  rename(`DollarUS/etudiant-Supérieur`=Supérieur)
```

```{r}
# selecting the variable indicatig the level of TFP in TFP dataset
MFP <- MFP |>
  select(Pays, TIME_PERIOD, `2015=100`)
```

```{r}
# joining the differents tables for the regression
REGRESS <- full_join(MFP, TOTALEDUSPEND, by=c("TIME_PERIOD", "Pays"))
REGRESS <- full_join(GDPcapita, REGRESS, by=c("TIME_PERIOD", "Pays"))
REGRESS <- full_join(TRADE, REGRESS, by=c("TIME_PERIOD", "Pays"))
REGRESS <- full_join(INST, REGRESS, by=c("TIME_PERIOD", "Pays"))
REGRESS <- full_join(SPENDRD, REGRESS, by=c("TIME_PERIOD", "Pays"))
```


# Performing regression
```{r}
# first regression: effect of spendings in higher education on TFP
summary(lm(formula =`2015=100`~`Imports%GDP`+ Pays+`DollarUS/etudiant-Supérieur`, data=REGRESS))|>
  tidy()|>
  mutate(p.value=as.character(p.value))|>
  kable( 
      caption = "Summary of Linear Model Coefficients", 
      col.names = c("Term", "Estimate", "Std. Error", "t value", "p value"))
```

```{r}
# first regression: summary statistics
summary(lm(formula =`2015=100`~`Imports%GDP`+ Pays+`DollarUS/etudiant-Supérieur`, data=REGRESS))|>
  (\(x) data.frame(
    Statistic = c("N", "R2", "Adjusted R2"),
    Value = c(x$df[1] + x$df[2], x$r.squared, x$adj.r.squared)
  ))() |>
  kable(
    caption = "Model Summary Statistics",
    col.names = c("Statistic", "Value")
  )

```


```{r}
# second regression: effect of spendings in research on TFP
summary(lm(formula =`2015=100`~`rsc2015=100`+`Imports%GDP`+ Pays, data=REGRESS))|>
  tidy()|>
  mutate(p.value=as.character(p.value))|>
  kable( 
      caption = "Summary of Linear Model Coefficients", 
      col.names = c("Term", "Estimate", "Std. Error", "t value", "p value"))
```  

```{r}
# second regression : summary statistics
summary(lm(formula =`2015=100`~`rsc2015=100`+`Imports%GDP`+ Pays, data=REGRESS))|>
  (\(x) data.frame(
    Statistic = c("N", "R2", "Adjusted R2"),
    Value = c(x$df[1] + x$df[2], x$r.squared, x$adj.r.squared)
  ))() |>
  kable(
    caption = "Model Summary Statistics",
    col.names = c("Statistic", "Value")
  )

```


# Research and Education

  The previous section shows evidence of a positive causal relationship between TFP growth and GDP growth. We now bring attention to two possible drivers of TFP and investigate the relationship between investment in higher education, research effort and TFP.

  Graph (number of the graph) shows a clear positive relationship between the levels of TFP and investment in R&D. When computing the coefficients of this linear regression, we find that the coefficient of the line displayed is statistically very significant (P<0.01). This first observation is coherent with intuition and contemporaneous research.
  
```{r}
# showing the correlation between research spendings and TFP in a graph
SPENDRD |>
  full_join(MFP,SPENDRD , by=c("TIME_PERIOD", "Pays")) |>
  group_by(Pays) |>
  mutate(value2015=`Millions de dollars US`[TIME_PERIOD=="2015"]) |>
  mutate(`rsc2015=100`=`Millions de dollars US`/value2015) |>
  ungroup()|>
ggplot(aes(x = `rsc2015=100`, y = `2015=100`)) +
  geom_point(size = 2, alpha = 0.5)+
  geom_smooth(method = "lm", se = FALSE, size = 1.2) +
  labs(
    title = "Relationship Between Research and TFP",
    x = "Research Spending",
    y = "TFP",    
   ) +
  theme_minimal() + 
  theme(
    plot.title = element_text(size = 16, face = "bold")
  ) +
  theme(legend.position = "none")
```

```{r}
# regressing research on TFP
REGP21 <- SPENDRD |>
  full_join(MFP,SPENDRD , by=c("TIME_PERIOD", "Pays")) |>
  group_by(Pays) |>
  mutate(value2015=`Millions de dollars US`[TIME_PERIOD=="2015"]) |>
  mutate(`rsc2015=100`=`Millions de dollars US`/value2015) |>
  ungroup()
  summary(lm(formula=`2015=100`~`rsc2015=100`, data=REGP21)) |>
  tidy()|>
  mutate(p.value=as.character(p.value))|>
  kable( 
      caption = "Summary of Linear Model Coefficients", 
      col.names = c("Term", "Estimate", "Std. Error", "t value", "p value"))
  
summary(lm(formula=`2015=100`~`rsc2015=100`, data=REGP21))|>
  (\(x) data.frame(
    Statistic = c("N", "R2", "Adjusted R2"),
    Value = c(x$df[1] + x$df[2], x$r.squared, x$adj.r.squared)
  ))() |>
  kable(
    caption = "Model Summary Statistics",
    col.names = c("Statistic", "Value")
  )
```



  As our intuition does, economic research have put forward the role of R&D in increasing TFP. Endogenous growth models describe TFP as a dependent variable of the R&D effort. Romer (1990) splits it in two parts: the number of workers implied in R&D and the efficiency of research, that is, how likely it is that researchers come up with a new idea. In this model, long term growth comes from the development of new intermediate inputs that allow for the production of new final outputs, hence increasing the quantity and variety of final goods available in the economy. We can think that research increases TFP (recall : a measure of the efficiency of the combination of labour and capital) not only by allowing the production of a larger variety of good but also with productivity improvement for the existing production. 
  
Literature, including the Romer model, also put forward the role of trade in increasing TFP, an interesting fact that we use in our computation. According to Romer, trade indeed allows foreign ideas to enter the domestic economy and, by exposing too more competition and broadening the markets (so the profit levels), it increases the optimal level of research. 

For our computations, we decided to use, as a variable to estimate the effect of research effort on TFP, the gross spending in research for each country of our dataset (in real terms). 


  
  Education on the other hand can be seen as an investment in Human Capital, which refers to the stock of knowledge, skills, health, and attributes that individuals possess, which enable them to work and produce economic value, an important factor in increasing productivity hence TFP according to economic literature.
  
A better education level leads to a more skilled workforce, that can consequently adapt to new technologies used in production, lead innovation (in the adoption of new technologies and as skilled researchers) and work efficiently.
As production, especially in economically advanced countries, becomes increasingly dependent on knowledge and technology, an educated workforce is essential to achieve higher production outputs. This higher productivity of educated workers can easily be demonstrated at the personal level : every job survey links education and skill level to higher incomes coming from more productive jobs.

Finally, We can also think of some other causal relationships between education and TFP. Education creates common values and social codes, that lead to more social cohesion, less violence and better common decisions, hence leading to better institutions. All these elements are linked to TFP as social and political stability, cohesion, quality of the regulations and institutions foster an efficient combination of labour and capital.



  For our computations, we decided to use, as a variable to estimate the effect of research effort on TFP, the gross spending in research for each country of our dataset (in real terms).


 
## Result interpretation : 


### Research :

Table (number of table) show the result of regressing... on ... controlling for ... because...

It shows that a one unit increase in the relative value of research spendings (base 100 in 2015) is associated with a highly significant (P<0.01) 0.09 increase in TFP relative level (base 100 in 2015) with a robust standard error ; a one 1% increase in the weight of imports relative to GDP is associated with a 0.56 unit increase in TFP relative level.

These results combined with the existing theory and the high R2 suggests that there exists a positive causal relationship between R&D spendings and TFP. Some remarks are to be done about it. 
The very low coefficient can be the consequence of several factors, on one hand, our subset of countries only embodies very highly developed economies with high level of spendings in R&D and of TFP, as shown in table 8 (mean of the spendings in R&D in the subset), consequently, there is not a lot of variation in the explanatory variable. However, the facts that, even with this issue the coefficient remains significantly positive suggests that this relationship is robust. 
It is interesting to notice that when we perform the same regression on Korea, a country that have experienced very rapid growth in the contemporary period ( table ...), we find a much higher coefficient, still highly significant and a very good fit of the model (R2 of 0.96). this result confirms our conclusion and suggests additionally that in countries experiencing rapid growth, the research effort plays a central role. 
On the other hand, recent economic research has shown a large decrease in research efficiency : research spendings have increased consequently, whereas the number of patent and TFP growth do not seem to grow accordingly. It is very likely that we captured that in our result as we concentrate on the last three decades and that the causality we aim at demonstrating is less and less important. 
Finally Table ... shows that, according to the recent work of ... (...), when controlling for quality of institutions, with the regulatory quality index of the world bank, we observe that the effect of research on TFP is reduced and that higher quality of institutions is significantly associated with higher TFP even though it reduces the model fit. 
 
Education : 
```{r}
REGRESS1 <- REGRESS |>
  filter(Pays=="Corée")
summary(lm(formula =`2015=100`~`rsc2015=100`+ `Imports%GDP`, data=REGRESS1))
```



When we perform the same regression with Spendings in education per student (Table …) , we find that a hundred dollar increase in the spending per student in higher education is associated with a very significant (P<0.01) increase of TFP (relative to 2015) of 0.0448 ; in addition, we find a very similar result for the effect of the exposition to trade. The fit of the model is however significantly lower than for the model for research.
Although this result associated with the before mentioned theory suggests the existence of a positive causal relationship between spendings in education and TFP level, we encounter the same problem of low variation in our subset of developed countries. 








