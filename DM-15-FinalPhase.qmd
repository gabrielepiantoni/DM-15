---
title: "DM-15-FinalPhase"
author: 
- "Dorian Nadal", 
- "Gabriele Piantoni"
format: pdf
---

```{r}
#Setting: Here i am
#| message: false
here :: i_am("DM-15.Rproj")
```

```{r}
#Setting: Packages
#| message: false
library(here)
library(vroom)
library(tidyverse)
library(knitr)
```

```{r}
#Setting: Data Import
#| message: false
EDUSPEND<-vroom(here("PROJET","EDUCATION DATA SETS","Education spending (OECD).csv"))
EDUTAIN<-vroom(here("PROJET","EDUCATION DATA SETS","Educational attainment, at least completed short-cycle tertiary, population 25+, total (World Bank).csv"))
GDPMFP<-vroom(here("PROJET","GDP & MFP DATASETS","GDP, MFP and GDP per hour worked (OECD).csv"))
GROSPEND<-vroom(here("PROJET","R&D DATA SETS","Gross domestic spending in R&D, Researchers per countries & Tridic Patent families (OECD).csv"))
CPI <-vroom(here("PROJET","CPI.csv"))
L<-vroom(here("PROJET","L.csv"))
K<-vroom(here("PROJET","K.csv"))
```
```{r}
# Data cleaning, formating : clean the raw data from irrelevant information in contains
EDUSPEND <- EDUSPEND|>select(Pays, Indicateur, Sujet, Mesure, TIME_PERIOD, OBS_VALUE)
EDUTAIN <- EDUTAIN|>select(-c(`Country Code`, `Series Name`, `Series Code`))
GDPMFP <- GDPMFP |> select(Pays, Indicateur, Sujet, Mesure, TIME_PERIOD, OBS_VALUE)
GROSPEND <- GROSPEND |> select(Pays, Indicateur, Sujet, Mesure, TIME_PERIOD, OBS_VALUE)
```

```{r}
# Data cleaning, formating : split the data into different tables, each one displaying one indicator and its different measures
GDP<-GDPMFP |> filter(Indicateur=="Produit intérieur brut (PIB)") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)
MFP <- GDPMFP|>filter(Indicateur=="Productivité multifactorielle")|>pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)
PRODUCTIVITY <- GDPMFP |> 
  filter(Indicateur=="PIB par heure travaillée")|>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)
```

```{r}
# Data cleaning, formating : same as previous chunk
TRIAD <- GROSPEND |> 
  filter(Indicateur=="Familles de brevets triadiques") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)

STATERSC <- GROSPEND |> 
  filter(Indicateur=="Chercheurs du secteur de l’État") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)

RSC <- GROSPEND |> 
  filter(Indicateur=="Chercheurs") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)

SPENDRD <- GROSPEND |> 
  filter(Indicateur=="Dépenses intérieures brutes de R-D") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)

EDUTAIN <- EDUTAIN |>
  pivot_longer(cols = -`Country Name`,
               names_to = "Year",
               values_to = "Value" 
               )
```


```{r}
# Data cleaning, formating : setting TOTALEDUSPEND i the right format
TOTALEDUSPEND <- EDUSPEND|>filter(Indicateur=="Dépenses d'éducation")|>pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)
```

```{r}
# Data cleaning, formating : removing the code of each TIME_PERIOD to allow for datamanipulation
colnames(EDUTAIN) <- gsub("\\s\\[YR\\d{4}\\]", "", colnames(EDUTAIN))
#ChatGPT generated
```






# Introduction

  This paper investigate the relationship between research, education and TFP growth. 
  We start by showing that TFP is worth of interest as it is one of the major drivers of economic growth. That demonstrated, we concentrate on our main goal, determining whether or not research and education trigger TFP growth.

# Research question presentation 

  We here point out that countries have experienced growth over the last decades then we use the augmented version of the neoclassical growth model of Solow and Swan (1956) to show that TFP is one of the major drivers of growth, hence justifying the interest of our question.

## Stylized facts

We use CPI(Consumption price index) from the OECD to compute the real GDP and GDP per capita. In order to get rid of the effect of inflation in the GDP growth that we compute herafter

```{r}
#filtering CPI
CPI <-CPI |>
  filter(Sujet=="Total") |>
  select(Pays,TIME_PERIOD,OBS_VALUE)
```

```{r}
# renaming column
CPI<-CPI |>
  rename(CPI = OBS_VALUE)
```

```{r}
#joining GDP and CPI data sets by two columns (Year, Pays)
GDP <-GDP |> 
  full_join(CPI, by=c("TIME_PERIOD","Pays"))
```

```{r}
# Computing realGDP
GDP <-GDP |>
  mutate(RealGDP=((`Millions de dollars US`/CPI)*100))
```

```{r}
# Computing realGDP per capita
GDP <-GDP |>
  mutate(RealGDPperCapita=((`Dollars US/habitant`/CPI)*100))
```

```{r}
# removing years after covid crisis not to have the catch up effect 
GDP <- GDP |>
  filter(TIME_PERIOD<="2020")
```

We create categories of countries to simplify the presentation and compute average growth rates

```{r}
#creating categroies of countries
GDP <- GDP |>
  mutate(OCDE = ifelse(Pays %in% c("Royaume-Uni", "France", "Canada", "Australie", 
                    "États-Unis", "Norvège", "Danemark", "Nouvelle-Zélande", 
                    "Chine (République populaire de)", "Corée", "Suisse", 
                    "Finlande", "Singapour", "Suède", "Allemagne", 
                    "Tchéquie", "Autriche", "Pologne", "Irlande", 
                    "Portugal", "Pays-Bas", "Hongrie", "Grèce", "Israël", 
                    "Luxembourg", "Belgique", "Japon", "Espagne", "Chili"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(AsianTigers = ifelse(Pays %in% c("Corée", "Singapour"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(Europe = ifelse(Pays %in% c("Royaume-Uni", "France", "Allemagne", "Norvège", "Danemark", "Nouvelle-Zélande", "Suisse", "Finlande", "Suède", "Pays-Bas", "Autriche", "Irlande", "Tchéquie", "Slovénie", "Pologne","Lettonie", "Lituanie", "Estonie", "Bulgarie", "Roumanie", "Croatie", "Portugal", "Italie", "Grèce", "Espagne", "Belgique", "Luxembourg", "Serbie", "Albanie", "Macédoine du Nord"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(Asia = ifelse(Pays %in% c("Chine (République populaire de)", "Arabie saoudite", 
          "Corée", "Singapour", "Japon", "Indonésie", "Israël"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(NorthAmerica = ifelse(Pays %in% c("Canada", "États-Unis", "Mexique"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(SouthAmerica = ifelse(Pays %in% c("Argentine", "Brésil", "Chili", "Colombie"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(Africa = ifelse(Pays %in% c("Afrique du Sud", "Cameroun", "Sénégal", "Maroc", "Madagascar", "Zambie"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(Oceania = ifelse(Pays %in% c("Australie", "Nouvelle-Zélande"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(CentralEurope = ifelse(Pays %in% c("Allemagne", "Autriche", "Pologne", "Tchéquie", 
                    "Slovénie", "Slovaquie", "Hongrie", "France"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(SouthernEurope = ifelse(Pays %in% c("Portugal", "Espagne", "Italie", "Grèce", 
                     "Croatie", "Malte"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(EasternEurope = ifelse(Pays %in% c("Roumanie", "Bulgarie", "Lettonie", "Lituanie", 
                    "Estonie", "Serbie", "Macédoine du Nord", "Albanie", 
                    "Russie", "Géorgie"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(NorthernEurope = ifelse(Pays %in% c("Royaume-Uni", "Norvège", "Danemark", 
                     "Suède", "Finlande", "Pays-Bas", "Irlande"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(Indevelopment = ifelse(Pays %in% c("Chine (République populaire de)", "Indonésie", 
                          "Inde", "Afrique du Sud", "Cameroun", 
                          "Zambie", "Maroc", "Madagascar", "Russie", 
                          "Senegal", "Colombie", "Argentine", "Arabie saoudite"), "YES", "NO"))
```

```{r}
#creating binary variables to indicate if a country belongs to a category
# List of YES/NO variables
yes_no_variables <- c("OCDE", 
                      "AsianTigers", 
                      "Europe", 
                      "Asia", 
                      "NorthAmerica", 
                      "SouthAmerica", 
                      "Africa", 
                      "Oceania", 
                      "CentralEurope", 
                      "SouthernEurope", 
                      "EasternEurope", 
                      "NorthernEurope", 
                      "Indevelopment")

for (var in yes_no_variables) {
  GDP <- GDP |>
    group_by(TIME_PERIOD) |>
    mutate(!!paste0("v", var) := ifelse(!!sym(var) == "YES", 
                                        mean(RealGDP [!!sym(var) == "YES"], na.rm = TRUE), 
                                        NA)) |>
    ungroup()
}
```








  



# Data sets descriptions

# Data analysis

# Conclusion
