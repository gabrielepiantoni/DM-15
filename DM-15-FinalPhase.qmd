---
title: "DM-15-FinalPhase"
author: 
- "Dorian Nadal"
- "Gabriele Piantoni"
format: pdf
execute:
  echo: false      
  warning: false  
  message: false   
---
---
title: "brutta"
format: pdf
---

---
title: "DM-15-FinalPhase"
author: 
- "Dorian Nadal"
- "Gabriele Piantoni"
format: pdf
execute:
  echo: false      
  warning: false  
  message: false   
---

```{r}
#Setting: Here i am
#| message: false
here :: i_am("DM-15.Rproj")
```

```{r}
#Setting: Packages
#| message: false
library(here)
library(vroom)
library(tidyverse)
library(knitr)
library(broom)
library(knitr)
library(patchwork)
```

```{r}
#Setting: Data Import
#| message: false
EDUSPEND<-vroom(here("PROJET","EDUCATION DATA SETS","Education spending (OECD).csv"))
EDUTAIN<-vroom(here("PROJET","EDUCATION DATA SETS","Educational attainment, at least completed short-cycle tertiary, population 25+, total (World Bank).csv"))
GDPMFP<-vroom(here("PROJET","GDP & MFP DATASETS","GDP, MFP and GDP per hour worked (OECD).csv"))
GROSPEND<-vroom(here("PROJET","R&D DATA SETS","Gross domestic spending in R&D, Researchers per countries & Tridic Patent families (OECD).csv"))
CPI <-vroom(here("PROJET","CPI.csv"))
L<-vroom(here("PROJET","L.csv"))
K<-vroom(here("PROJET","K.csv"))
```
```{r}
#Setting: Here i am
#| message: false
here :: i_am("DM-15.Rproj")
```

```{r}
#Setting: Packages
#| message: false
library(here)
library(vroom)
library(tidyverse)
library(knitr)
library(broom)
library(knitr)
library(patchwork)
```

```{r}
#Setting: Data Import
#| message: false
EDUSPEND<-vroom(here("PROJET","EDUCATION DATA SETS","Education spending (OECD).csv"))
EDUTAIN<-vroom(here("PROJET","EDUCATION DATA SETS","Educational attainment, at least completed short-cycle tertiary, population 25+, total (World Bank).csv"))
GDPMFP<-vroom(here("PROJET","GDP & MFP DATASETS","GDP, MFP and GDP per hour worked (OECD).csv"))
GROSPEND<-vroom(here("PROJET","R&D DATA SETS","Gross domestic spending in R&D, Researchers per countries & Tridic Patent families (OECD).csv"))
CPI <-vroom(here("PROJET","CPI.csv"))
L<-vroom(here("PROJET","L.csv"))
K<-vroom(here("PROJET","K.csv"))
```
```{r}
# Data cleaning, formating : clean the raw data from irrelevant information in contains
EDUSPEND <- EDUSPEND|>select(Pays, Indicateur, Sujet, Mesure, TIME_PERIOD, OBS_VALUE)
EDUTAIN <- EDUTAIN|>select(-c(`Country Code`, `Series Name`, `Series Code`))
GDPMFP <- GDPMFP |> select(Pays, Indicateur, Sujet, Mesure, TIME_PERIOD, OBS_VALUE)
GROSPEND <- GROSPEND |> select(Pays, Indicateur, Sujet, Mesure, TIME_PERIOD, OBS_VALUE)
```

```{r}
# Data cleaning, formating : split the data into different tables, each one displaying one indicator and its different measures
GDP<-GDPMFP |> filter(Indicateur=="Produit intérieur brut (PIB)") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)
MFP <- GDPMFP|>filter(Indicateur=="Productivité multifactorielle")|>pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)
PRODUCTIVITY <- GDPMFP |> 
  filter(Indicateur=="PIB par heure travaillée")|>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)
```

```{r}
# Data cleaning, formating : same as previous chunk
TRIAD <- GROSPEND |> 
  filter(Indicateur=="Familles de brevets triadiques") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)

STATERSC <- GROSPEND |> 
  filter(Indicateur=="Chercheurs du secteur de l’État") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)

RSC <- GROSPEND |> 
  filter(Indicateur=="Chercheurs") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)

SPENDRD <- GROSPEND |> 
  filter(Indicateur=="Dépenses intérieures brutes de R-D") |>
  pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)

EDUTAIN <- EDUTAIN |>
  pivot_longer(cols = -`Country Name`,
               names_to = "Year",
               values_to = "Value" 
               )
```


```{r}
# Data cleaning, formating : setting TOTALEDUSPEND i the right format
TOTALEDUSPEND <- EDUSPEND|>filter(Indicateur=="Dépenses d'éducation")|>pivot_wider(
  names_from = "Mesure",
  values_from = "OBS_VALUE"
)
```

```{r}
# Data cleaning, formating : removing the code of each TIME_PERIOD to allow for datamanipulation
colnames(EDUTAIN) <- gsub("\\s\\[YR\\d{4}\\]", "", colnames(EDUTAIN))
#ChatGPT generated
```
```{r}
#filtering CPI
CPI <-CPI |>
  filter(Sujet=="Total") |>
  select(Pays,TIME_PERIOD,OBS_VALUE)
```

```{r}
# renaming column
CPI<-CPI |>
  rename(CPI = OBS_VALUE)
```

```{r}
#joining GDP and CPI data sets by two columns (Year, Pays)
GDP <-GDP |> 
  full_join(CPI, by=c("TIME_PERIOD","Pays"))
```

```{r}
# Computing realGDP
GDP <-GDP |>
  mutate(RealGDP=((`Millions de dollars US`/CPI)*100))
```

```{r}
# Computing realGDP per capita
GDP <-GDP |>
  mutate(RealGDPperCapita=((`Dollars US/habitant`/CPI)*100))
```

```{r}
# removing years after covid crisis not to have the catch up effect 
GDP <- GDP |>
  filter(TIME_PERIOD<="2020")
```

```{r}
#creating categroies of countries
#excluding Israël because of aberrant values
#excluding Russia because of aberrant values
#excluding Colombia because of aberrant values

GDP <- GDP |>
  mutate(`Euro Area and GB` = ifelse(Pays %in% c("France", "Ex-République fédérale d'Allemagne", "Finlande", "Lettonie", 
  "Slovénie", "Irlande", "Autriche", "Malte", "Italie", "Chypre", "Croatie", 
  "Portugal", "Pays-Bas", "Grèce", "République slovaque", "Luxembourg", 
  "Belgique", "Lituanie", "Estonie", "Espagne","Royaume-Uni" ), "YES", "NO"))
         
GDP <- GDP |>
  mutate(AsianTigers = ifelse(Pays %in% c("Corée", "Singapour"), "YES", "NO"))

GDP <- GDP |>
  mutate(EtatsUnis = ifelse(Pays %in% c("États-Unis"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(Europe = ifelse(Pays %in% c("Royaume-Uni", "France", "Allemagne", "Norvège", "Danemark", "Nouvelle-Zélande", "Suisse", "Finlande", "Suède", "Pays-Bas", "Autriche", "Irlande", "Tchéquie", "Slovénie", "Pologne","Lettonie", "Lituanie", "Estonie", "Bulgarie", "Roumanie", "Croatie", "Portugal", "Italie", "Grèce", "Espagne", "Belgique", "Luxembourg", "Serbie", "Albanie", "Macédoine du Nord"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(CentralEurope = ifelse(Pays %in% c("Allemagne", "Autriche", "Pologne", "Tchéquie", 
                    "Slovénie", "Slovaquie", "Hongrie", "France"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(SouthernEurope = ifelse(Pays %in% c("Portugal", "Espagne", "Italie", "Grèce", 
                     "Croatie", "Malte"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(EasternEurope = ifelse(Pays %in% c("Lettonie", "Lituanie", "Estonie"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(NorthernEurope = ifelse(Pays %in% c("Royaume-Uni", "Norvège", "Danemark", 
                     "Suède", "Finlande", "Pays-Bas", "Irlande"), "YES", "NO"))
         
GDP <- GDP |>
  mutate(China = ifelse(Pays %in% c("Chine (République populaire de)"), "YES", "NO"))
```

```{r}
#creating binary variables to indicate if a country belongs to a category
# List of YES/NO variables
# computing average GDP (variables starting with v)
yes_no_variables <- c( 
                      "AsianTigers", 
                      "Europe",
                      "CentralEurope", 
                      "SouthernEurope", 
                      "EasternEurope", 
                      "NorthernEurope", 
                      "EtatsUnis",
                      "China",
                      "Euro Area and GB")

for (var in yes_no_variables) {
  GDP <- GDP |>
    group_by(TIME_PERIOD) |>
    mutate(!!paste0("v", var) := ifelse(!!sym(var) == "YES", 
                                        mean(RealGDP [!!sym(var) == "YES"], na.rm = TRUE), 
                                        NA)) |>
    ungroup()
}
```

```{r}
# computing average GDP per capita
# variables starting with c
for (var in yes_no_variables) {
  GDP <- GDP |>
    group_by(TIME_PERIOD) |>
    mutate(!!paste0("c", var) := ifelse(!!sym(var) == "YES", 
                                        mean(RealGDPperCapita [!!sym(var) == "YES"], na.rm = TRUE), 
                                        NA)) |>
    ungroup()
}
```


```{r}
#| output: false
#Graphs: Real GDP per capita - Euro Area and GB, ASIANTIGERS, China, united states
graph1 <-GDP |>
  pivot_longer(cols = c("cEtatsUnis", 
                   "cAsianTigers", 
                   "cChina",
                   "cEuro Area and GB"),
               names_to = "Region",
               values_to="avgGDP"
               ) |>
  filter(!is.na(avgGDP)) |>
  filter(TIME_PERIOD >=1995) |>
  ggplot(aes(y=avgGDP, x=TIME_PERIOD, color=Region)) +
  geom_line()
```

```{r}
#| output: false
#Graphs: Real GDP - EUROPE
graph2<-GDP |>
  pivot_longer(cols = c("cEurope", 
                      "cCentralEurope", 
                      "cSouthernEurope", 
                      "cEasternEurope", 
                      "cNorthernEurope"),
               names_to = "Region",
               values_to="avgGDP"
               ) |>
  filter(!is.na(avgGDP)) |>
  filter (TIME_PERIOD>=1995) |>
  ggplot(aes(y=avgGDP, x=TIME_PERIOD, color=Region)) +
  geom_line()
```

# Research question presentation

## Introduction

 In recent decades, most of the countries has achieved sustained positive growth, leading them to a marked improvement in their quality of life.
That said, recent years have shown, especially in the more developed economies, a slow down in this trend. To date, the consensus seems to agree that the deflation of the explosive growth that persisted for most of the 20th century is to be attributed to a less sustained growth in technical change which, according to theory, is strongly linked to the amount of resources devoted to research and education.
Well, given the relevance of the topic, we thought it would be interesting to try to determine if the data are coherent with the existence of a causal relationship between the level of research, education and the growth in technical change exists.

## Stylized facts: the relarionship within groeth rate of GDP and TFP

### The performance of world economies in recent decades: a positive scenario

As mentioned above, the economic development of several countries has undergone positive growth in recent decades. In the following graphs (*Graph 1* and *Graph 2*), this phenomenon is highlighted. 

With the aim of obtaining a more coherent representation of the economic development of a selected group of countries and to express more adequately the level of welfare, the graphs below displays **real GDP per capita** - obtaining applying the inflation (CPI) to the nominalk GDP - over the period between 1995 and 2020.

More in detail,

 - *Graph 1* contains data for the USA, Asian Tigers (North Korea and Singapore), China and EuroArea (2023).
 - *Graph 2* contains data for European countries by geographical location
```{r}
#| fig.width: 12
#| fig.height: 4
graph1 + graph2 +
  plot_layout(widths = c(10, 10))
```

```{r}
#Computing the growth rate of GDP
GDP <- GDP |>
  group_by(Pays) |>
arrange(TIME_PERIOD)|> mutate(growth_rateY = ((RealGDP- lag(RealGDP)) / lag(RealGDP)) * 100) |>
  arrange(Pays,TIME_PERIOD)
```

```{r}
#| output: false
#Graphs: Growth_rate GDP - Germany, France, US and South Corea
graph3 <-GDP |>
  filter(Pays=="France"|Pays== "États-Unis"|Pays== "Allemagne"|Pays== "Corée") |>
  ggplot(aes(x=TIME_PERIOD, y=growth_rateY, color=Pays)) +
  geom_smooth(method="lm", se=FALSE)

```

```{r}
#| output: false
##Graphs: TFP growth - Germany, France, US and South Corea
graph4<-MFP|>
   filter(Pays=="France"|Pays== "Chine (République populaire de)"|Pays== "États-Unis"|Pays== "Allemagne"|Pays== "Corée") |>
  ggplot(aes(x=TIME_PERIOD, y=`Taux de croissance annuel (%)`, color=Pays)) +
  geom_smooth(method="lm", se=FALSE)
```
### Not all that glitters is gold: the slowdown in economic growth

Although growth in recent decades has remained positive, it has been declining in several world economies. *Graph 3* gives an initial and rough idea of this phenomenon.
Looking again at some of the countries included in the sample used in *Graph 1* and *Graph 2*, *Graph 3* shows a fall in the **growth rate of real GDP** in countries of global significance, such as the USA, Germany, France and South Korea.

### *Could technical change (TFP) be the culprit in the growth slowdown?*

Economic literature has always theorised the centrality of technical change within economic expansion.  *Graph 4*, together with the already presented *Graph 3*, attempts to give an initial empirical insight into this relationship.
*Graph* 4, which considers the same countries used in the previous chart, highlights the development of TFP growth between 1970 and 2020. As can easily be seen, the graphical relationship with *Graph 4* is evident, suggesting a possible **causal relationship between TFP and GDP growth**.
```{r}
#| fig.width: 12
#| fig.height: 4
graph3+graph4
```

```{r}
#formatting L
L<-L |>
  select(TIME_PERIOD,Pays,Indicateur, OBS_VALUE )
L<-L |>
  pivot_wider(names_from = Indicateur,
              values_from = OBS_VALUE)
```

```{r}
#Computing total hours worked
L<-L |>
  mutate(L = `Population active`*`Heures travaillées`)
```

```{r}
# Computing the growth rate of L
L<-L |>
  group_by(Pays) |>
arrange(TIME_PERIOD)|> mutate(growth_rateL = ((L- lag(L)) / lag(L)) * 100) |>
  arrange(Pays,TIME_PERIOD)
```

```{r}
# Cleaning K
K<-K |> 
  select(Pays, TIME_PERIOD, Mesure, OBS_VALUE) |>
  filter(Mesure=="Taux de croissance annuel (%)") |>
  pivot_wider(names_from=Mesure, 
              values_from=OBS_VALUE) |>
  arrange(Pays, TIME_PERIOD) |>
  rename(growth_rateK= `Taux de croissance annuel (%)` )
```

```{r}
# Creating the dataset for growth decomposition
Dec <- GDP |>
  select(Pays, TIME_PERIOD, growth_rateY)
```

```{r}
# Creating the dataset for growth decomposition
Dec<-Dec |>
  full_join(K, Dec, by=c("TIME_PERIOD", "Pays"))
```

```{r}
# Creating the dataset for growth decomposition
Dec <- Dec |>
  full_join(L, Dec, by=c("TIME_PERIOD", "Pays")) |>
  select(, Pays, TIME_PERIOD, growth_rateY, growth_rateK, growth_rateL)
```

```{r}
# Creating the dataset for growth decomposition
MFP <- MFP |>
  rename(growth_rateA=`Taux de croissance annuel (%)`)
```

```{r}
# Creating the dataset for growth decomposition
Dec <-Dec |>
  full_join(MFP, Dec, by=c("TIME_PERIOD", "Pays")) |>
  select(Pays, TIME_PERIOD, growth_rateY, growth_rateK, growth_rateL, growth_rateA)
```

```{r}
#| output: false
# Creating the dataset for growth decomposition : checking the accuracy
Dec |>
  mutate(check=growth_rateY-(0.33*growth_rateK+0.66*(growth_rateL+ growth_rateA))) |>
  filter(Pays=="France" | Pays=="Allemagne"| Pays=="Corée")
```
### Technical change and economic growth: a causal relationship

Although the result of the previous section is interesting, its statistical relevance is far from being achieved. For this reason, in the current section we will draw more statistically relevant conclusions.

Considering the typical neoclassical production function
$$
Y = (AL)^{1−\alpha}K^{\alpha}
$$
, output growth (i.e. GDP) - taking logs and derivatives - can be decomposed into the following components: capital growth ($g_K$), labour force growth ($g_L$) and TFP growth ($g_A$). Consequently, the benchmark formula becomes
$$
g_Y = \alpha g_K + (1 - \alpha)(g_A + g_L)
$$
sing $\alpha$=1/3, as it is the commonly used value for this parameter and this value tends to remain the same over time (Kaldor fact: the share of capital in production tends to be constant).
At this point, it is crucial to demonstrate the empirical validity of this formula by referring to the period between 1990 and 2020.
*Figure 5*, which considers the USA, France and Germany, decomposes the growth that occurred over the 30-year period, considering both variables endogenous and exogenous to the model. As can be seen from the representation, the explanatory variables largely justify the economic growth trend.
```{r}
# France
# Solow-Swan model
Solow <- Dec |>
  filter(Pays == "France") |>
  arrange(TIME_PERIOD) |>
  mutate(
    growth_rateY = (100 + growth_rateY) / 100,
    growth_rateK = (100 + growth_rateK) / 100,
    growth_rateL = (100 + growth_rateL) / 100,
    growth_rateA = (100 + growth_rateA) / 100
  ) |>
  filter(TIME_PERIOD >= 1990 & TIME_PERIOD <= 2015) |>
  mutate(
    growth_rate_totalL = 0.66*prod(growth_rateL),
    growth_rate_totalY = prod(growth_rateY),
    growth_rate_totalK = 0.33*prod(growth_rateK),
    growth_rate_totalA = 0.66*prod(growth_rateA)
  ) |>
  mutate(others = growth_rate_totalY - growth_rate_totalK - growth_rate_totalL - growth_rate_totalA)|>
  select(growth_rate_totalL, growth_rate_totalA, growth_rate_totalK, others, growth_rate_totalY)
```

```{r}
#| output: false
# France 
Solow1 <- Solow |>
  pivot_longer(
    cols = c(growth_rate_totalL, growth_rate_totalA, growth_rate_totalK, others),
    names_to = "Component",
    values_to = "Value"
  )

# Bar chart decomposition
graph5 <- ggplot(Solow1, aes(x = "", y = Value, fill = Component)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Growth rate decomposition (France, Germany,USA, 1990-2015)",
    x = NULL,
    y = "Growth Rate Contribution",
    fill = "Component"
  ) +
  theme_minimal() +
  theme(legend.position = "none", axis.text.x = element_blank(), axis.ticks.x = element_blank())
```


```{r}
# Germany
# Solow-Swan model
Solow2 <- Dec |>
  filter(Pays == "Allemagne") |>
  arrange(TIME_PERIOD) |>
  mutate(
    growth_rateY = (100 + growth_rateY) / 100,
    growth_rateK = (100 + growth_rateK) / 100,
    growth_rateL = (100 + growth_rateL) / 100,
    growth_rateA = (100 + growth_rateA) / 100
  ) |>
  filter(TIME_PERIOD >= 1990 & TIME_PERIOD <= 2015) |>
  mutate(
    growth_rate_totalL = 0.66*prod(growth_rateL),
    growth_rate_totalY = prod(growth_rateY),
    growth_rate_totalK = 0.33*prod(growth_rateK),
    growth_rate_totalA = 0.66*prod(growth_rateA)
  ) |>
  mutate(others = growth_rate_totalY - growth_rate_totalK - growth_rate_totalL - growth_rate_totalA)|>
  select(growth_rate_totalL, growth_rate_totalA, growth_rate_totalK, others, growth_rate_totalY)
```

```{r}
#| output: false
# Germany 
Solow3 <- Solow2 |>
  pivot_longer(
    cols = c(growth_rate_totalL, growth_rate_totalA, growth_rate_totalK, others),
    names_to = "Component",
    values_to = "Value"
  )

# Bar chart decomposition
graph6<-ggplot(Solow3, aes(x = "", y = Value, fill = Component)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  theme(legend.position = "none", axis.text.x = element_blank(), axis.ticks.x = element_blank())
```

```{r}
# USA
# Solow-Swan model
Solow4 <- Dec |>
  filter(Pays == "États-Unis") |>
  arrange(TIME_PERIOD) |>
  mutate(
    growth_rateY = (100 + growth_rateY) / 100,
    growth_rateK = (100 + growth_rateK) / 100,
    growth_rateL = (100 + growth_rateL) / 100,
    growth_rateA = (100 + growth_rateA) / 100
  ) |>
  filter(TIME_PERIOD >= 1990 & TIME_PERIOD <= 2015) |>
  mutate(
    growth_rate_totalL = 0.66*prod(growth_rateL),
    growth_rate_totalY = prod(growth_rateY),
    growth_rate_totalK = 0.33*prod(growth_rateK),
    growth_rate_totalA = 0.66*prod(growth_rateA)
  ) |>
  mutate(others = growth_rate_totalY - growth_rate_totalK - growth_rate_totalL - growth_rate_totalA)|>
  select(growth_rate_totalL, growth_rate_totalA, growth_rate_totalK, others, growth_rate_totalY)
```

```{r}
#| output: false
# USA 
Solow5 <- Solow4 |>
  pivot_longer(
    cols = c(growth_rate_totalL, growth_rate_totalA, growth_rate_totalK, others),
    names_to = "Component",
    values_to = "Value"
  )

# Bar chart decomposition
graph7 <-ggplot(Solow5, aes(x = "", y = Value, fill = Component)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  theme(axis.text.x = element_blank(), axis.ticks.x = element_blank())
```

```{r}
#| fig.width: 12
#| fig.height: 4
graph5+graph6+graph7
```
Once the reliability of the model has been proven, the causality of the relationship between TFP and GDP growth can be demonstrated using **linear regressions** where $g_Y$ (i.e. dependent variable) is demonstrated through the components (i.e. independent variables) $g_L$, $g_K$ and $g_A$.

In the first instance, the results of an all-inclusive linear regression are demonstrated in *Table 1*. As shown, statistical significance levels (ie. p value < 0.5) are met and an interesting coefficient is attributed to the $g_A$ component, emphasising the intensity of the causal relationship between TFP and GDP.

```{r}
#linear model : regression of L, K, A on Y
summary(lm(formula =growth_rateY~growth_rateK+growth_rateL+growth_rateA, data=na.exclude(Dec))) |>
  tidy()|>
  mutate(p.value=as.character(p.value))|>
  kable( 
      caption = "Summary of Linear Model Coefficients", 
      col.names = c("Term", "Estimate", "Std. Error", "t value", "p value"))
```
On the other hand, *Table 2* shows a  $R^2$ and an adjusted $R^2$ of 0.32. Nevertheless, considering that the aim of our model is not to make forecasts, we can be satisfied with such a value.
```{r}
lm(formula =growth_rateY~growth_rateK+growth_rateL+growth_rateA, data=na.exclude(Dec))|>
summary() |>
  (\(x) data.frame(
    Statistic = c("N", "R2", "Adjusted R2"),
    Value = c(x$df[1] + x$df[2], x$r.squared, x$adj.r.squared)
  ))() |>
  kable(
    caption = "Model Summary Statistics",
    col.names = c("Statistic", "Value")
  )

```


Moreover, *Table 3* shows the results of a linear regression controlling for individual countries. Again, the significance levels for the above components are statistically acceptable and the coefficients tend to the values previously obtained and the causality between GDP and TFP is confirmed. In addition, the coefficient for the binary variable associated with different countries are globally not significant, that is, differences across countries do not add much information about the relation between TFP growth and GDP growth.


```{r}
#linear model : regression of L, K, A on Y

summary(lm(formula =growth_rateY~growth_rateK+growth_rateL+growth_rateA+Pays, data=na.exclude(Dec))) |>
  tidy()|>
  mutate(p.value=as.character(p.value))|>
  kable( 
      caption = "Summary of Linear Model Coefficients", 
      col.names = c("Term", "Estimate", "Std. Error", "t value", "p value"))
```
On the other hand, *Table 4* shows a  $R^2$ of 0.39 and an adjusted $R^2$ of 0.37. Nevertheless, considering that the aim of our model is not to make forecasts, we can be satisfied with such a value.
```{r}
lm(formula = growth_rateY ~ growth_rateK + growth_rateL + growth_rateA + Pays, data = na.exclude(Dec)) |>
summary() |>
  (\(x) data.frame(
    Statistic = c("N", "R2", "Adjusted R2"),
    Value = c(x$df[1] + x$df[2], x$r.squared, x$adj.r.squared)
  ))() |>
  kable(
    caption = "Model Summary Statistics",
    col.names = c("Statistic", "Value")
  )

```
Considering these evidence and the theoretical framework provided, we can believe, with confidence, in the existence of a strong causal relationship between TFP growth and GDP growth.

# Data sets descriptions

# Data analysis

# Conclusion




